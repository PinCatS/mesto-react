(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{17:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(7),i=n.n(o),r=n(10),s=n(2),u=(n(3),n.p+"static/media/logo.1f1e9591.svg"),l=n(0);var p=function(){return Object(l.jsx)("header",{className:"header page__header",children:Object(l.jsx)("img",{src:u,alt:"\u041b\u043e\u0433\u043e Mesto",className:"header__logo"})})};document.querySelector(".profile__edit-button"),document.querySelector(".profile__add-button"),document.querySelector(".profile__avatar-button");function d(e,t){var n=e?"".concat(e.status," ").concat(e.statusText):null;console.error(t,n)}var _=n(8),b=n(9),j=new(function(){function e(t,n){Object(_.a)(this,e),this._url=t,this._headers=n}return Object(b.a)(e,[{key:"_onResponse",value:function(e){return e.ok?e.json():Promise.reject({status:e.status,statusText:e.statusText})}},{key:"getCards",value:function(){return fetch("".concat(this._url,"cards"),{headers:this._headers}).then(this._onResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"users/me"),{headers:this._headers}).then(this._onResponse)}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._url,"users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._onResponse)}},{key:"setProfile",value:function(e,t){return fetch("".concat(this._url,"users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._onResponse)}},{key:"addCard",value:function(e,t){return fetch("".concat(this._url,"cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._onResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._onResponse)}},{key:"setLike",value:function(e){return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._onResponse)}},{key:"removeLike",value:function(e){return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._onResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.removeLike(e):this.setLike(e)}}]),e}())("https://mesto.nomoreparties.co/v1/cohort-20/",{authorization:"9a69937c-ba0b-400f-a7bf-af3d18fbfaea","content-type":"application/json"}),f=Object(a.createContext)();var m=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,o=e.onCardDelete,i=Object(a.useContext)(f),r=t.owner._id===i._id,s="button card__remove-button ".concat(r?"card__remove-button_visible":""),u=t.likes.some((function(e){return e._id===i._id})),p="button card__like-button ".concat(u?"card__like-button_active":"");return Object(l.jsxs)("li",{className:"card",children:[Object(l.jsx)("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",className:s,onClick:function(){return o(t)}}),Object(l.jsx)("img",{className:"card__image",src:t.link,alt:"\u041a\u0430\u043c\u0447\u0430\u0442\u043a\u0430",onClick:function(){return n(t)}}),Object(l.jsxs)("div",{className:"card__info",children:[Object(l.jsx)("h2",{className:"card__title",children:t.name}),Object(l.jsxs)("div",{className:"card__like",children:[Object(l.jsx)("button",{type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",className:p,onClick:function(){return c(t)}}),Object(l.jsx)("p",{className:"card__like-counter",children:null===t||void 0===t?void 0:t.likes.length})]})]})]})};var h=function(e){var t=e.cards,n=e.onEditProfile,c=e.onAddPlace,o=e.onEditAvatar,i=e.onCardClick,r=e.onCardLike,s=e.onCardDelete,u=Object(a.useContext)(f);return Object(l.jsxs)("main",{className:"content page__content",children:[Object(l.jsxs)("section",{className:"profile",children:[u&&Object(l.jsxs)("div",{className:"profile__info",children:[Object(l.jsx)("div",{className:"profile__avatar-button",onClick:o,children:Object(l.jsx)("img",{className:"profile__avatar",src:u.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"})}),Object(l.jsxs)("div",{className:"profile__info-text",children:[Object(l.jsx)("h1",{className:"profile__name",children:u.name}),Object(l.jsx)("p",{className:"profile__activity",children:u.about}),Object(l.jsx)("button",{type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile-edit-button",className:"button profile__edit-button",onClick:n})]})]}),Object(l.jsx)("button",{type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",name:"profile-add-button",className:"button profile__add-button",onClick:c})]}),Object(l.jsx)("section",{className:"places page__places","aria-label":"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043c\u0435\u0441\u0442",children:Object(l.jsx)("ul",{className:"cards",children:t.map((function(e){return Object(l.jsx)(m,{card:e,onCardClick:i,onCardLike:r,onCardDelete:s},e._id)}))})})]})};var O=function(){return Object(l.jsx)("footer",{className:"footer page__footer",children:Object(l.jsx)("p",{className:"footer__copyright",children:"\xa92020 Mesto Russia"})})};var v=function(e){var t=e.card,n=e.onClose;return t&&Object(l.jsx)("div",{className:"popup image-popup popup_opened",children:Object(l.jsxs)("figure",{className:"popup__container popup__container_size_small image-popup__container",children:[Object(l.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"button popup__close-button popup__close-button_location_topright",onClick:n}),Object(l.jsx)("img",{className:"image-popup__image",src:t.link,alt:t.name}),Object(l.jsx)("figcaption",{className:"image-popup__caption",children:t.name})]})})},x=n(11);var g=function(e){var t=e.title,n=e.name,c=e.isOpen,o=e.onClose,i=e.onSubmit,r=e.isFormValid,s=e.children,u=(Object(x.a)(e,["title","name","isOpen","onClose","onSubmit","isFormValid","children"]),Object(a.useRef)());return Object(a.useEffect)((function(){r&&r(u.current.checkValidity())})),Object(l.jsx)("div",{className:"popup popup_name_".concat(n," ").concat(c&&"popup_opened"),children:Object(l.jsxs)("form",{ref:u,className:"popup__container popup__form",name:"".concat(n,"-form"),onSubmit:i,noValidate:!0,children:[Object(l.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0440\u043c\u0443",className:"button popup__close-button",onClick:o}),Object(l.jsx)("h2",{className:"popup__heading",children:t}),Object(l.jsx)("fieldset",{className:"popup__info",children:s})]})})};var C=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,o=e.isLoading,i=Object(a.useContext)(f),r=Object(a.useState)(""),u=Object(s.a)(r,2),p=u[0],d=u[1],_=Object(a.useState)(""),b=Object(s.a)(_,2),j=b[0],m=b[1],h=Object(a.useState)(!1),O=Object(s.a)(h,2),v=O[0],x=O[1],C=Object(a.useRef)(),k=Object(a.useRef)(),N=Object(a.useState)(null),y=Object(s.a)(N,2),S=y[0],L=y[1],R=Object(a.useState)(null),E=Object(s.a)(R,2),A=E[0],D=E[1];return Object(a.useEffect)((function(){var e,t;d(null!==(e=null===i||void 0===i?void 0:i.name)&&void 0!==e?e:""),m(null!==(t=null===i||void 0===i?void 0:i.about)&&void 0!==t?t:"")}),[i]),Object(l.jsxs)(g,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:function(){!function(){var e,t;d(null!==(e=null===i||void 0===i?void 0:i.name)&&void 0!==e?e:""),m(null!==(t=null===i||void 0===i?void 0:i.about)&&void 0!==t?t:""),L(null),D(null)}(),n()},onSubmit:function(e){e.preventDefault(),c({name:p,about:j})},isFormValid:function(e){return x(e)},children:[Object(l.jsx)("input",{type:"text",ref:C,className:"form-input popup__input popup__input_name_name",name:"profile-name",value:p,onChange:function(e){d(e.target.value),C.current.validity.valid?L(null):L(C.current.validationMessage)},placeholder:"\u0418\u043c\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f",minLength:"2",maxLength:"40",required:!0}),Object(l.jsx)("span",{className:"popup__input-error popup__input-error_name_profile-name ".concat(S&&"popup__input-error_active"),children:S}),Object(l.jsx)("input",{type:"text",ref:k,className:"form-input popup__input popup__input_name_activity",name:"profile-activity",value:j,onChange:function(e){m(e.target.value),k.current.validity.valid?D(null):D(k.current.validationMessage)},placeholder:"\u0414\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c",minLength:"2",maxLength:"200",required:!0}),Object(l.jsx)("span",{className:"popup__input-error popup__input-error_name_profile-activity ".concat(A&&"popup__input-error_active"),children:A}),Object(l.jsx)("button",{type:"submit",className:"button popup__save-button ".concat(!v&&"popup__save-button_disabled"),disabled:!v,children:o?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var k=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,o=e.isLoading,i=Object(a.useState)(""),r=Object(s.a)(i,2),u=r[0],p=r[1],d=Object(a.useState)(!1),_=Object(s.a)(d,2),b=_[0],j=_[1],f=Object(a.useRef)(),m=Object(a.useState)(null),h=Object(s.a)(m,2),O=h[0],v=h[1],x=function(){p(""),v(null)};return Object(l.jsxs)(g,{name:"update-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:function(){x(),n()},onSubmit:function(e){e.preventDefault(),c(u),x()},isFormValid:function(e){j(e)},children:[Object(l.jsx)("input",{type:"url",ref:f,className:"form-input popup__input popup__input_name_avatar-link",name:"avatar-link",value:u,onChange:function(e){p(e.target.value),f.current.validity.valid?v(null):v(f.current.validationMessage)},placeholder:"https://somewebsite.com/someimage.jpg",required:!0}),Object(l.jsx)("span",{className:"popup__input-error popup__input-error_name_avatar-link ".concat(O&&"popup__input-error_active"),children:O}),Object(l.jsx)("button",{type:"submit",className:"button popup__save-button ".concat(!b&&"popup__save-button_disabled"),disabled:!b,children:o?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var N=function(e){var t=e.isOpen,n=e.onClose,c=e.onCardAdd,o=e.isLoading,i=Object(a.useState)(""),r=Object(s.a)(i,2),u=r[0],p=r[1],d=Object(a.useState)(""),_=Object(s.a)(d,2),b=_[0],j=_[1],f=Object(a.useState)(!1),m=Object(s.a)(f,2),h=m[0],O=m[1],v=Object(a.useState)(null),x=Object(s.a)(v,2),C=x[0],k=x[1],N=Object(a.useState)(null),y=Object(s.a)(N,2),S=y[0],L=y[1],R=Object(a.useRef)(),E=Object(a.useRef)(),A=function(){p(""),j(""),k(null),L(null)};return Object(l.jsxs)(g,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:function(){A(),n()},onSubmit:function(e){e.preventDefault(),c({name:u,link:b}),A()},isFormValid:function(e){return O(e)},children:[Object(l.jsx)("input",{type:"text",ref:R,className:"form-input popup__input popup__input_name_place-name",name:"place-name",value:u,onChange:function(e){p(e.target.value),R.current.validity.valid?k(null):k(R.current.validationMessage)},placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0}),Object(l.jsx)("span",{className:"popup__input-error popup__input-error_name_place-name ".concat(C&&"popup__input-error_active"),children:C}),Object(l.jsx)("input",{type:"url",ref:E,className:"form-input popup__input popup__input_name_place-image-url",name:"place-image-url",value:b,onChange:function(e){j(e.target.value),E.current.validity.valid?L(null):L(E.current.validationMessage)},placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(l.jsx)("span",{className:"popup__input-error popup__input-error_name_place-image-url ".concat(S&&"popup__input-error_active"),children:S}),Object(l.jsx)("button",{type:"submit",className:"button popup__save-button ".concat(!h&&"popup__save-button_disabled"),disabled:!h,children:o?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})};var y=function(e){var t=e.isOpen,n=e.onClose,a=e.onDeleteConfirm,c=e.isLoading;return Object(l.jsx)(g,{name:"remove-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a(),n()},children:Object(l.jsx)("button",{type:"submit",className:"button popup__save-button",children:c?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430"})})};var S=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),i=Object(s.a)(o,2),u=i[0],_=i[1],b=Object(a.useState)(!1),m=Object(s.a)(b,2),x=m[0],g=m[1],S=Object(a.useState)(!1),L=Object(s.a)(S,2),R=L[0],E=L[1],A=Object(a.useState)([]),D=Object(s.a)(A,2),F=D[0],P=D[1],T=Object(a.useState)(!1),U=Object(s.a)(T,2),q=U[0],M=U[1],V=Object(a.useState)(null),w=Object(s.a)(V,2),J=w[0],I=w[1],z=Object(a.useState)(null),H=Object(s.a)(z,2),B=H[0],G=H[1],K=Object(a.useState)(null),Q=Object(s.a)(K,2),W=Q[0],X=Q[1];Object(a.useEffect)((function(){j.getUserInfo().then((function(e){return X(e)})).catch((function(e){return d(e,"Failed to get user info.")})),j.getCards().then((function(e){return P(e)})).catch((function(e){return d(e,"Failed to get cards.")}))}),[]);var Y=function(){c(!1),_(!1),g(!1),I(null),E(!1),G(null)};return Object(l.jsx)("div",{className:"App page",children:Object(l.jsxs)(f.Provider,{value:W,children:[Object(l.jsx)(p,{}),Object(l.jsx)(h,{cards:F,onEditProfile:function(){c(!0)},onAddPlace:function(){_(!0)},onEditAvatar:function(){g(!0)},onCardClick:function(e){I(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===W._id}));j.changeLikeCardStatus(e._id,t).then((function(t){P((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return d(e,"Failed to change like status.")}))},onCardDelete:function(e){G(e),E(!0)}}),Object(l.jsx)(O,{}),Object(l.jsx)(C,{isOpen:n,onClose:Y,onUpdateUser:function(e){var t=e.name,n=e.about;M(!0),j.setProfile(t,n).then((function(e){return X(e)})).catch((function(e){return d(e,"Failed to edit profile.")})).finally((function(){M(!1),Y()}))},isLoading:q}),Object(l.jsx)(N,{isOpen:u,onClose:Y,onCardAdd:function(e){var t=e.name,n=e.link;M(!0),j.addCard(t,n).then((function(e){P([e].concat(Object(r.a)(F)))})).catch((function(e){return d(e,"Failed to add new card.")})).finally((function(){M(!1),Y()}))},isLoading:q}),Object(l.jsx)(k,{isOpen:x,onClose:Y,onUpdateAvatar:function(e){M(!0),j.updateAvatar(e).then((function(e){return X(e)})).catch((function(e){return d(e,"Failed to update avatar.")})).finally((function(){M(!1),Y()}))},isLoading:q}),Object(l.jsx)(v,{card:J,onClose:Y}),Object(l.jsx)(y,{isOpen:R,onClose:Y,onDeleteConfirm:function(){M(!0),j.deleteCard(B._id).then((function(){P((function(e){return e.filter((function(e){return e._id!==B._id}))}))})).catch((function(e){return d(e,"Failed to remove card.")})).finally((function(){M(!1),G(null),Y()}))},isLoading:q})]})})};i.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(S,{})}),document.getElementById("root"))},3:function(e,t,n){}},[[17,1,2]]]);
//# sourceMappingURL=main.d391fdd6.chunk.js.map